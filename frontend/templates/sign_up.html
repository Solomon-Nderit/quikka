<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quikka — Sign up or Log in</title>
  <link rel="stylesheet" href="auth.css" />
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container">
      <a class="brand" href="/">
        <img class="logo" src="/frontend/public/landing_page.png" alt="Quikka" />
        <span>Quikka</span>
      </a>
      <div class="nav-links">
        <a href="#pricing">Pricing</a>
        <a href="#learn">Learn</a>
        <a href="#help">Help</a>
      </div>
      <div class="nav-cta">
        <a class="btn ghost" href="/">Home</a>
        <a class="btn primary" href="#" id="navLoginBtn">Log in</a>
      </div>
    </div>
  </nav>

  <main class="main">
    <div class="card" id="authCard">
      <h1 id="formTitle">Sign up for free</h1>

      <!-- Sign up form -->
  <form id="signupForm" class="form" autocomplete="on" novalidate action="http://localhost:8000/signup" method="post">
        <div>
          <label for="su-email" class="label">Email</label>
          <input type="email" id="su-email" name="email" placeholder="you@example.com" class="input" required />
        </div>
        <div>
          <label for="su-password" class="label">Password</label>
          <input type="password" id="su-password" name="password" placeholder="Create a password" class="input" minlength="6" required />
        </div>
        <div class="action">
          <button type="submit" class="btn primary block">Sign up</button>
        </div>
        <div class="badge-line">Or continue with</div>
        <button type="button" class="btn social block" aria-label="Continue with Google">
          <span>⚪</span>
          <span>Continue with Google</span>
        </button>
        <div class="toggle-links">
          <span>Already have an account? </span><a href="#" class="link" id="toLogin">Log in</a>
        </div>
      </form>

      <!-- Login form -->
      <form id="loginForm" class="form" autocomplete="on" novalidate style="display:none">
        <div>
          <label for="li-email" class="label">Email</label>
          <input type="email" id="li-email" name="email" placeholder="you@example.com" class="input" required />
        </div>
        <div>
          <label for="li-password" class="label">Password</label>
          <input type="password" id="li-password" name="password" placeholder="Your password" class="input" required />
        </div>
        <div class="action">
          <button type="submit" class="btn primary block">Log in</button>
        </div>
        <div class="toggle-links">
          <span>New to Quikka? </span><a href="#" class="link" id="toSignup">Create an account</a>
        </div>
      </form>

      <p class="subtle" id="formCaption">Use 6+ characters with a mix of letters and numbers.</p>
    </div>
  </main>

  <script>
    (function(){
      const signupForm = document.getElementById('signupForm');
      const loginForm = document.getElementById('loginForm');
      const toLogin = document.getElementById('toLogin');
      const toSignup = document.getElementById('toSignup');
      const title = document.getElementById('formTitle');
      const caption = document.getElementById('formCaption');
      const navLoginBtn = document.getElementById('navLoginBtn');

      function show(mode){
        const isSignup = mode === 'signup';
        signupForm.style.display = isSignup ? 'flex' : 'none';
        loginForm.style.display = isSignup ? 'none' : 'flex';
        title.textContent = isSignup ? 'Sign up for free' : 'Welcome back';
        caption.textContent = isSignup ? 'Use 6+ characters with a mix of letters and numbers.' : 'Enter your credentials to continue.';
        // Reflect state in URL hash without reloading
        history.replaceState(null, '', isSignup ? '#signup' : '#login');
      }

      // Initial state based on hash
      if (location.hash === '#login') show('login'); else show('signup');

      toLogin.addEventListener('click', e => { e.preventDefault(); show('login'); });
      toSignup.addEventListener('click', e => { e.preventDefault(); show('signup'); });
      navLoginBtn.addEventListener('click', e => { e.preventDefault(); show('login'); });

      // Basic demo handlers
      signupForm.addEventListener('submit', async e => {
        e.preventDefault();
        const email = document.getElementById('su-email').value.trim();
        const password = document.getElementById('su-password').value;
        const submitBtn = signupForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Signing up...';
        try {
          const res = await fetch('http://localhost:8000/signup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
          });
          const data = await res.json().catch(() => ({}));
          if (!res.ok) {
            const msg = (data && (data.message || data.error?.message)) || `Request failed (${res.status})`;
            throw new Error(msg);
          }
          alert('Sign up successful');
          // Optionally redirect or switch to login
          // show('login');
        } catch (err) {
          alert('Sign up failed: ' + err.message);
        } finally {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
      loginForm.addEventListener('submit', e => {
        e.preventDefault();
        alert('Login submitted');
      });
    })();
  </script>
</body>
</html>
